<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>è‰¾æ¢ç´¢æå…‰è§‚æµ‹ç³»ç»Ÿ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'aurora-green': '#00ffcc',
            'aurora-red': '#ff3366',
            'aurora-orange': '#ff9933',
            'aurora-blue': '#33ccff',
            'aurora-purple': '#9966ff'
          },
          animation: {
            'high-pulse': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'medium-pulse': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite'
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .text-shadow {
        text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
      }
      .text-shadow-heavy {
        text-shadow: 0 0 10px rgba(0, 0, 0, 0.7);
      }
      .glass-effect {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .region-high {
        box-shadow: 0 0 15px rgba(255, 51, 102, 0.8);
      }
      .region-warning {
        box-shadow: 0 0 15px rgba(255, 153, 51, 0.8);
      }
      .live-badge {
        top: 4px;
        right: 4px;
        animation: blink 1.5s infinite;
      }
      @keyframes blink {
        0% { opacity: 1; }
        50% { opacity: 0.4; }
        100% { opacity: 1; }
      }
      /* ç¦æ­¢å›¾ç‰‡ä¿å­˜ç›¸å…³æ ·å¼ */
      .no-save {
        pointer-events: none;
        user-select: none;
      }
    }
  </style>
</head>

<body class="bg-transparent min-h-screen">
  <div class="min-h-[100vh] bg-gradient-to-br from-gray-900 to-blue-900 p-4 overflow-auto">
    <!-- é¡¶éƒ¨åŒºåŸŸï¼šç³»ç»Ÿåç§° + å®æ—¶ç”»é¢ -->
    <div class="mb-6">
      <!-- ç³»ç»Ÿåç§° -->
      <div class="text-left mb-3">
        <h1 class="text-white text-2xl font-bold text-shadow">è‰¾æ¢ç´¢æå…‰è§‚æµ‹ç³»ç»Ÿ</h1>
        <div class="flex items-center mt-1">
          <div id="datetime" class="text-gray-300 text-sm mr-4"></div>
          <div id="live-location" class="text-aurora-green text-sm"></div>
        </div>
      </div>
      
      <!-- æå…‰å®æ—¶ç”»é¢åŒºåŸŸï¼ˆå·¦ä¸Šæ–¹ï¼‰ -->
      <div class="relative rounded-xl overflow-hidden mb-6 shadow-lg">
        <div class="absolute live-badge bg-aurora-red text-white text-xs px-2 py-0.5 rounded-full z-10">
          <i class="fa fa-circle mr-1"></i>å®æ—¶ç”»é¢
        </div>
        <!-- æ·»åŠ ç¦æ­¢ä¿å­˜ç›¸å…³å±æ€§ -->
        <img 
          src="https://pics.starvisor.net/galleries/orig/cap_bag.jpg" 
          alt="è‰¾æ¢ç´¢æå…‰å®æ—¶è§‚æµ‹ç”»é¢" 
          class="w-full h-auto rounded-xl object-cover no-save"
          oncontextmenu="return false;"  <!-- ç¦æ­¢å³é”®èœå• -->
          ondragstart="return false;"    <!-- ç¦æ­¢æ‹–æ‹½ -->
        >
        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2">
          <p class="text-white text-xs" id="image-update-time">æå…‰å®æ—¶è§‚æµ‹ç”»é¢ | æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°</p>
        </div>
      </div>
    </div>
    
    <!-- é¢„è­¦ä¿¡æ¯åŒºåŸŸ -->
    <div class="mb-6 p-4 glass-effect rounded-xl">
      <div id="forecast-title" class="font-bold text-lg text-center mb-2"></div>
      <div class="flex items-center justify-center mb-3">
        <i id="wind-speed-icon" class="fa fa-bolt mr-2"></i>
        <span id="kp-display" class="text-white text-xl font-bold"></span>
      </div>
      <div id="warning-text" class="text-base font-bold text-center"></div>
      
      <!-- å¤ªé˜³æ´»åŠ¨æ•°æ® -->
      <div class="grid grid-cols-3 gap-2 mt-4 text-sm">
        <div class="text-center p-2 glass-effect rounded-lg">
          <div class="text-gray-400">å¤ªé˜³é£é€Ÿ</div>
          <div id="solar-wind" class="text-aurora-green"></div>
        </div>
        <div class="text-center p-2 glass-effect rounded-lg">
          <div class="text-gray-400">HPIå¼ºåº¦</div>
          <div id="hpi-power" class="text-aurora-blue"></div>
        </div>
        <div class="text-center p-2 glass-effect rounded-lg">
          <div class="text-gray-400">ç£åœºæ–¹å‘</div>
          <div id="bz-direction" class="text-aurora-purple"></div>
        </div>
      </div>
    </div>
    
    <!-- åŸå¸‚åˆ—è¡¨å®¹å™¨ -->
    <div class="grid grid-cols-2 gap-3 mb-6">
      <!-- åŸå¸‚1ï¼šåŒ—ææ‘ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-arctic">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">åŒ—ææ‘</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="arctic-prob">æ¦‚ç‡: 85%</span><br>
          <span id="arctic-cloud">äº‘é‡: 10%</span><br>
          <span id="arctic-temp">æ¸©åº¦: -13Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚2ï¼šæ»¡å½’é•‡ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-mangui">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">æ»¡å½’é•‡</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="mangui-prob">æ¦‚ç‡: 70%</span><br>
          <span id="mangui-cloud">äº‘é‡: 15%</span><br>
          <span id="mangui-temp">æ¸©åº¦: -10Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚3ï¼šæ ¹æ²³å¸‚ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-genhe">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">æ ¹æ²³å¸‚</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="genhe-prob">æ¦‚ç‡: 78%</span><br>
          <span id="genhe-cloud">äº‘é‡: 12%</span><br>
          <span id="genhe-temp">æ¸©åº¦: -11Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚4ï¼šé¢å°”å¤çº³ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-eerguna">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">é¢å°”å¤çº³</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="eerguna-prob">æ¦‚ç‡: 90%</span><br>
          <span id="eerguna-cloud">äº‘é‡: 5%</span><br>
          <span id="eerguna-temp">æ¸©åº¦: -15Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚5ï¼šé»‘æ²³å¸‚ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-heihe">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">é»‘æ²³å¸‚</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="heihe-prob">æ¦‚ç‡: 65%</span><br>
          <span id="heihe-cloud">äº‘é‡: 20%</span><br>
          <span id="heihe-temp">æ¸©åº¦: -5Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚6ï¼šç¦¾æœ¨æ‘ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-hegu">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">ç¦¾æœ¨æ‘</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="hegu-prob">æ¦‚ç‡: 80%</span><br>
          <span id="hegu-cloud">äº‘é‡: 12%</span><br>
          <span id="hegu-temp">æ¸©åº¦: -12Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚7ï¼šæµ·æ‹‰å°” -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-hailar">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">æµ·æ‹‰å°”</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="hailar-prob">æ¦‚ç‡: 75%</span><br>
          <span id="hailar-cloud">äº‘é‡: 18%</span><br>
          <span id="hailar-temp">æ¸©åº¦: -18Â°C</span>
        </div>
      </div>
      
      <!-- åŸå¸‚8ï¼šæ‰å…°å±¯ -->
      <div class="text-center region-container glass-effect p-3 rounded-xl" id="city-zalantun">
        <div class="text-white text-base font-semibold mb-1 text-shadow-heavy">æ‰å…°å±¯</div>
        <div class="text-white text-sm">
          <span class="text-aurora-green" id="zalantun-prob">æ¦‚ç‡: 88%</span><br>
          <span id="zalantun-cloud">äº‘é‡: 8%</span><br>
          <span id="zalantun-temp">æ¸©åº¦: -20Â°C</span>
        </div>
      </div>
    </div>

    <!-- åº•éƒ¨ä¿¡æ¯ -->
    <div class="text-center text-gray-400 text-xs mt-4 pb-4">
      <div>æ•°æ®æ›´æ–°äº <span id="last-update">--</span></div>
      <div>è‰¾æ¢ç´¢æå…‰è§‚æµ‹ç³»ç»Ÿ Â© 2025</div>
    </div>
  </div>

  <script>
  // ç¦æ­¢å›¾ç‰‡ä¿å­˜çš„é¢å¤–ä¿æŠ¤
  document.addEventListener('contextmenu', function(e) {
    // é˜»æ­¢å³é”®èœå•ï¼ˆé’ˆå¯¹å›¾ç‰‡å’Œæ•´ä½“é¡µé¢ï¼‰
    if (e.target.tagName === 'IMG') {
      e.preventDefault();
      return false;
    }
  });

  // é…ç½®åŒºåŸŸ
  const _0x1a2b = {
    anchorLocation: {
      name: "ä¸­å›½åŒ—éƒ¨åœ°åŒº",
      lat: 53.5,
      lon: 122.3,
      timezone: "Asia/Shanghai"
    },
    
    locations: {
      arctic: { name: "åŒ—ææ‘", lat: 53.5, lon: 122.3, factor: 1.25 },
      heihe: { name: "é»‘æ²³å¸‚", lat: 50.2, lon: 127.5, factor: 1.18 },
      mangui: { name: "æ»¡å½’é•‡", lat: 52.0, lon: 122.0, factor: 1.15 },
      genhe: { name: "æ ¹æ²³å¸‚", lat: 50.8, lon: 121.5, factor: 1.15 },
      eerguna: { name: "é¢å°”å¤çº³", lat: 50.2, lon: 120.2, factor: 1.08 },
      hegu: { name: "ç¦¾æœ¨æ‘", lat: 48.5, lon: 87.4, factor: 0.85 },
      hailar: { name: "æµ·æ‹‰å°”", lat: 49.2, lon: 119.7, factor: 1.05 },
      zalantun: { name: "æ‰å…°å±¯", lat: 48.0, lon: 122.7, factor: 0.90 }
    },
    
    thresholds: {
      probability: {
        low: 30,
        medium: 66
      },
      cloudCover: {
        low: 30,
        medium: 70
      },
      temperature: {
        cold: -20,
        medium: -10
      },
      windSpeed: {
        medium: 500,
        high: 600
      }
    },
    
    auroraRefresh: 2 * 60 * 1000,
    weatherRefresh: 10 * 60 * 1000,
    imageRefresh: 5 * 60 * 1000
  };

  // æ•°æ®çŠ¶æ€
  const _0x2c3d = {
    kpIndex: "--",
    forecastTime: "--",
    globalProb: 0,
    lastUpdate: null,
    hpiPower: 0,
    bzDirection: 0,
    solarWind: 0,
    solarDensity: 0
  };

  // DOMå…ƒç´ ç¼“å­˜
  const _0x3e4f = {
    forecastTitle: document.getElementById('forecast-title'),
    datetime: document.getElementById('datetime'),
    liveLocation: document.getElementById('live-location'),
    warningText: document.getElementById('warning-text'),
    windSpeedIcon: document.getElementById('wind-speed-icon'),
    kpDisplay: document.getElementById('kp-display'),
    lastUpdate: document.getElementById('last-update'),
    solarWind: document.getElementById('solar-wind'),
    hpiPower: document.getElementById('hpi-power'),
    bzDirection: document.getElementById('bz-direction'),
    liveImage: document.querySelector('img[alt="è‰¾æ¢ç´¢æå…‰å®æ—¶è§‚æµ‹ç”»é¢"]'),
    imageUpdateTime: document.getElementById('image-update-time'),
    cities: {
      arctic: {
        container: document.getElementById('city-arctic'),
        prob: document.getElementById('arctic-prob'),
        cloud: document.getElementById('arctic-cloud'),
        temp: document.getElementById('arctic-temp')
      },
      mangui: {
        container: document.getElementById('city-mangui'),
        prob: document.getElementById('mangui-prob'),
        cloud: document.getElementById('mangui-cloud'),
        temp: document.getElementById('mangui-temp')
      },
      genhe: {
        container: document.getElementById('city-genhe'),
        prob: document.getElementById('genhe-prob'),
        cloud: document.getElementById('genhe-cloud'),
        temp: document.getElementById('genhe-temp')
      },
      eerguna: {
        container: document.getElementById('city-eerguna'),
        prob: document.getElementById('eerguna-prob'),
        cloud: document.getElementById('eerguna-cloud'),
        temp: document.getElementById('eerguna-temp')
      },
      heihe: {
        container: document.getElementById('city-heihe'),
        prob: document.getElementById('heihe-prob'),
        cloud: document.getElementById('heihe-cloud'),
        temp: document.getElementById('heihe-temp')
      },
      hegu: {
        container: document.getElementById('city-hegu'),
        prob: document.getElementById('hegu-prob'),
        cloud: document.getElementById('hegu-cloud'),
        temp: document.getElementById('hegu-temp')
      },
      hailar: {
        container: document.getElementById('city-hailar'),
        prob: document.getElementById('hailar-prob'),
        cloud: document.getElementById('hailar-cloud'),
        temp: document.getElementById('hailar-temp')
      },
      zalantun: {
        container: document.getElementById('city-zalantun'),
        prob: document.getElementById('zalantun-prob'),
        cloud: document.getElementById('zalantun-cloud'),
        temp: document.getElementById('zalantun-temp')
      }
    }
  };

  // å·¥å…·å‡½æ•°
  function _0x4a5b(_0x5c6d) {
    if (_0x5c6d) _0x5c6d.className = '';
  }
  
  function _0x5b7c(_0x6d8e) {
    if (_0x6d8e >= _0x1a2b.thresholds.probability.medium) {
      return 'text-aurora-red high-pulse';
    } else if (_0x6d8e >= _0x1a2b.thresholds.probability.low) {
      return 'text-aurora-orange medium-pulse';
    } else {
      return 'text-gray-400';
    }
  }
  
  function _0x6c9d(_0x7eaf) {
    if (_0x7eaf >= _0x1a2b.thresholds.cloudCover.medium) {
      return 'text-aurora-red';
    } else if (_0x7eaf >= _0x1a2b.thresholds.cloudCover.low) {
      return 'text-aurora-orange';
    } else {
      return 'text-aurora-green';
    }
  }
  
  function _0x7dae(_0x8fbf) {
    if (_0x8fbf <= _0x1a2b.thresholds.temperature.cold) {
      return 'text-aurora-blue';
    } else if (_0x8fbf <= _0x1a2b.thresholds.temperature.medium) {
      return 'text-aurora-purple';
    } else {
      return 'text-white';
    }
  }
  
  function _0x8ebf(_0x9fcg) {
    if (_0x9fcg >= _0x1a2b.thresholds.windSpeed.high) {
      return 'text-aurora-red high-pulse';
    } else if (_0x9fcg >= _0x1a2b.thresholds.windSpeed.medium) {
      return 'text-aurora-orange medium-pulse';
    } else {
      return 'text-aurora-green';
    }
  }

  // æ ¸å¿ƒåŠŸèƒ½
  function _0x9fd0() {
    const _0xaf01 = new Date();
    const _0xbf12 = _0xaf01.getFullYear();
    const _0xcf23 = String(_0xaf01.getMonth() + 1).padStart(2, '0');
    const _0xdf34 = String(_0xaf01.getDate()).padStart(2, '0');
    const _0xef45 = String(_0xaf01.getHours()).padStart(2, '0');
    const _0xff56 = String(_0xaf01.getMinutes()).padStart(2, '0');
    const _0x0f67 = String(_0xaf01.getSeconds()).padStart(2, '0');
    
    const _0x1f78 = `${_0xbf12}/${_0xcf23}/${_0xdf34}`;
    const _0x2f89 = `${_0xef45}:${_0xff56}:${_0x0f67}`;
    
    _0x3e4f.datetime.innerHTML = `${_0x1f78} ${_0x2f89}`;
  }

  function _0x3f9a(_0x4aab, _0x5bbc, _0x6ccd, _0x7dde, _0x8eef, _0x9ff0) {
    let _0xaf01 = 0;
    const _0xbf12 = 30;
    
    if (_0x4aab >= 90) _0xaf01 += 35;
    else if (_0x4aab >= 70) _0xaf01 += 25;
    else if (_0x4aab >= 50) _0xaf01 += 15;

    if (_0x6ccd < -15) _0xaf01 += 30;
    else if (_0x6ccd < -10) _0xaf01 += 20;
    else if (_0x6ccd < -5) _0xaf01 += 10;

    if (_0x7dde >= 750) _0xaf01 += 20;
    else if (_0x7dde >= 600) _0xaf01 += 15;
    else if (_0x7dde >= 500) _0xaf01 += 10;
    else if (_0x7dde >= 400) _0xaf01 += 5;

    _0xaf01 += Math.min(5, _0x8eef);

    if (_0xbf12 >= 30) _0xaf01 += 10;
    else if (_0xbf12 >= 20) _0xaf01 += 7;
    else if (_0xbf12 >= 10) _0xaf01 += 3;

    _0xaf01 *= _0x9ff0;

    return Math.min(95, Math.max(5, _0xaf01));
  }

  function _0x4fab() {
    if (_0x2c3d.kpIndex === "--") return;
    
    for (const [_0x5cbc, _0x6dcd] of Object.entries(_0x1a2b.locations)) {
      const _0x7ede = _0x3f9a(
        _0x2c3d.hpiPower || 0,
        30,
        _0x2c3d.bzDirection || 0,
        _0x2c3d.solarWind || 0,
        _0x2c3d.solarDensity || 0,
        _0x6dcd.factor
      );
      
      const _0x8fef = _0x3e4f.cities[_0x5cbc];
      if (!_0x8fef || !_0x8fef.prob) continue;
      
      const _0x9ff0 = _0x7ede < _0x1a2b.thresholds.probability.low 
        ? "æ¦‚ç‡: ä½" 
        : `æ¦‚ç‡: ${Math.round(_0x7ede)}%`;
      
      _0x8fef.prob.textContent = _0x9ff0;
      _0x4a5b(_0x8fef.prob);
      _0x8fef.prob.className = `text-sm font-medium ${_0x5b7c(_0x7ede)} text-shadow-heavy`;
      
      _0x4a5b(_0x8fef.container);
      _0x8fef.container.className = 'text-center region-container glass-effect p-3 rounded-xl';
      if (_0x7ede >= _0x1a2b.thresholds.probability.medium) {
        _0x8fef.container.classList.add('region-high');
      } else if (_0x7ede >= _0x1a2b.thresholds.probability.low) {
        _0x8fef.container.classList.add('region-warning');
      }
    }
    
    let _0xaf01 = 0;
    let _0xbf12 = 0;
    for (const [_0x5cbc, _0x6dcd] of Object.entries(_0x1a2b.locations)) {
      const _0x7ede = _0x3f9a(
        _0x2c3d.hpiPower || 0,
        30,
        _0x2c3d.bzDirection || 0,
        _0x2c3d.solarWind || 0,
        _0x2c3d.solarDensity || 0,
        _0x6dcd.factor
      );
      _0xaf01 += _0x7ede;
      _0xbf12++;
    }
    _0x2c3d.globalProb = Math.round(_0xaf01 / _0xbf12);
    
    _0x3e4f.kpDisplay.textContent = `KP: ${_0x2c3d.kpIndex}`;
    
    _0x6cbd();
    
    if (_0x2c3d.forecastTime !== "--") {
      _0x3e4f.forecastTitle.textContent = `${_0x2c3d.forecastTime}åˆ†é’Ÿåæå…‰é¢„æŠ¥`;
      
      _0x4a5b(_0x3e4f.forecastTitle);
      _0x3e4f.forecastTitle.className = `font-bold text-lg ${_0x8ebf(_0x2c3d.solarWind)} text-shadow`;
      
      _0x4a5b(_0x3e4f.windSpeedIcon);
      _0x3e4f.windSpeedIcon.className = `fa fa-bolt mr-2 ${_0x8ebf(_0x2c3d.solarWind)}`;
    }
  }

  function _0x6cbd() {
    let _0x7dce = "";
    let _0x8edf = "text-white";
    
    if (_0x2c3d.globalProb >= _0x1a2b.thresholds.probability.medium) {
      _0x7dce = `ğŸ”¥ æå…‰å¼ºé¢„è­¦ï¼šç»¼åˆæ¦‚ç‡${_0x2c3d.globalProb}%ï¼Œå…‰æ±¡æŸ“ç­‰çº§â‰¤2çº§åœ°åŒºï¼ˆé»‘æš—å¤œç©ºï¼‰è‚‰çœ¼å¯è§‚æµ‹ï¼Œå»ºè®®å‰å¾€å¼€é˜”æ— é®æŒ¡åŒºåŸŸ`;
      _0x8edf = "text-aurora-red";
    } else if (_0x2c3d.globalProb >= _0x1a2b.thresholds.probability.low) {
      _0x7dce = `âš ï¸ æå…‰é¢„è­¦ï¼šç»¼åˆæ¦‚ç‡${_0x2c3d.globalProb}%ï¼Œæ‰‹æœºæˆ–ç›¸æœºå…·å¤‡æ‹æ‘„å¯èƒ½æ€§ï¼›å»ºè®®åœ¨**å…‰æ±¡æŸ“ç­‰çº§â‰¤2çº§**ï¼ˆæš—ç©ºç¯å¢ƒï¼‰åŒºåŸŸï¼Œé€‰æ‹©å¼€é˜”æ— é®æŒ¡ç‚¹ä½å°è¯•æ‹æ‘„ï¼Œå¯ä¼˜å…ˆæ­é…ä¸‰è„šæ¶æå‡ç”»è´¨`;
      _0x8edf = "text-aurora-orange";
    } else {
      _0x7dce = "å½“å‰æ— æå…‰é¢„è­¦ä¿¡æ¯";
      _0x8edf = "text-gray-300";
    }
    
    _0x3e4f.warningText.textContent = _0x7dce;
    
    _0x4a5b(_0x3e4f.warningText);
    if (_0x2c3d.globalProb >= _0x1a2b.thresholds.probability.medium) {
      _0x3e4f.warningText.className = `${_0x8edf} text-base font-bold text-center high-pulse text-shadow-heavy`;
    } else if (_0x2c3d.globalProb >= _0x1a2b.thresholds.probability.low) {
      _0x3e4f.warningText.className = `${_0x8edf} text-base font-bold text-center medium-pulse text-shadow-heavy`;
    } else {
      _0x3e4f.warningText.className = `${_0x8edf} text-base font-bold text-center text-shadow-heavy`;
    }
  }

  function _0x7dce() {
    for (const [_0x8edf, _0x9ff0] of Object.entries(_0x3e4f.cities)) {
      if (_0x9ff0.cloud) {
        const _0xaf01 = _0x9ff0.cloud.textContent;
        const _0xbf12 = parseInt(_0xaf01.match(/\d+/)[0]);
        _0x4a5b(_0x9ff0.cloud);
        _0x9ff0.cloud.className = `text-sm font-medium ${_0x6c9d(_0xbf12)} text-shadow-heavy`;
      }
      
      if (_0x9ff0.temp) {
        const _0xaf01 = _0x9ff0.temp.textContent;
        const _0xbf12 = parseInt(_0xaf01.match(/-?\d+/)[0]);
        _0x4a5b(_0x9ff0.temp);
        _0x9ff0.temp.className = `text-sm font-medium ${_0x7dae(_0xbf12)} text-shadow-heavy`;
      }
    }
  }

  function _0x8edf() {
    _0x3e4f.liveLocation.textContent = _0x1a2b.anchorLocation.name;
    _0x4fab();
    _0x7dce();
    
    if (_0x3e4f.solarWind) _0x3e4f.solarWind.textContent = `${_0x2c3d.solarWind} km/s`;
    if (_0x3e4f.hpiPower) _0x3e4f.hpiPower.textContent = _0x2c3d.hpiPower;
    if (_0x3e4f.bzDirection) _0x3e4f.bzDirection.textContent = `${_0x2c3d.bzDirection} nT`;
    
    _0x2c3d.lastUpdate = new Date().toLocaleTimeString();
    if (_0x3e4f.lastUpdate) _0x3e4f.lastUpdate.textContent = _0x2c3d.lastUpdate;
  }

  // å®æ—¶ç”»é¢åˆ·æ–°åŠŸèƒ½
  function refreshLiveImage() {
    if (_0x3e4f.liveImage) {
      // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
      const timestamp = new Date().getTime();
      const originalSrc = "https://pics.starvisor.net/galleries/orig/cap_bag.jpg";
      _0x3e4f.liveImage.src = `${originalSrc}?t=${timestamp}`;
      
      // æ›´æ–°ç”»é¢åº•éƒ¨çš„æ—¶é—´æç¤º
      const updateTime = new Date().toLocaleTimeString();
      if (_0x3e4f.imageUpdateTime) {
        _0x3e4f.imageUpdateTime.textContent = `æå…‰å®æ—¶è§‚æµ‹ç”»é¢ | æœ€è¿‘æ›´æ–°: ${updateTime}`;
      }
    }
  }

  // APIè°ƒç”¨å‡½æ•°
  async function fetchAuroraData() {
    try {
      // è·å–KPæŒ‡æ•°
      try {
        const kpRes = await fetch('https://services.swpc.noaa.gov/json/planetary_k_index_1m.json');
        const kpData = await kpRes.json();
        if (kpData?.length > 0) {
          const latestKp = kpData[kpData.length - 1];
          _0x2c3d.kpIndex = latestKp.estimated_kp?.toFixed(1) || "--";
        }
      } catch (e) {
        console.warn("KPæŒ‡æ•°è·å–å¤±è´¥", e);
      }
      
      // è·å–å¤ªé˜³é£æ•°æ®
      try {
        const plasmaRes = await fetch('https://services.swpc.noaa.gov/products/solar-wind/plasma-2-hour.json');
        const plasmaData = await plasmaRes.json();
        
        if (Array.isArray(plasmaData) && plasmaData.length > 1) {
          const headers = plasmaData[0];
          const speedIndex = headers.indexOf("speed");
          const densityIndex = headers.indexOf("density");
          const latest = plasmaData[plasmaData.length - 1];
          
          if (speedIndex !== -1 && latest[speedIndex]) {
            _0x2c3d.solarWind = parseFloat(latest[speedIndex]);
            _0x2c3d.solarDensity = parseFloat(latest[densityIndex]);
            
            const distanceKm = 1500000;
            const delayMinutes = 2;
            const arrivalTimeMinutes = Math.round((distanceKm / _0x2c3d.solarWind / 60) + delayMinutes);
            _0x2c3d.forecastTime = arrivalTimeMinutes;
          }
        }
      } catch (e) {
        console.warn("å¤ªé˜³é£æ•°æ®è·å–å¤±è´¥", e);
      }
      
      // è·å–HPIå¼ºåº¦
      try {
        const hpiRes = await fetch('https://services.swpc.noaa.gov/text/aurora-nowcast-hemi-power.txt');
        const hpiText = await hpiRes.text();
        const validLines = hpiText.trim().split("\n").filter(line => !line.startsWith("#"));
        if (validLines.length > 0) {
          const lastLine = validLines[validLines.length - 1];
          const columns = lastLine.split(/\s+/).filter(Boolean);
          if (columns.length >= 3) {
            _0x2c3d.hpiPower = parseFloat(columns[2]) || 0;
          }
        }
      } catch (e) {
        console.warn("HPIå¼ºåº¦è·å–å¤±è´¥", e);
      }
      
      // è·å–Bzæ–¹å‘
      try {
        const magRes = await fetch('https://services.swpc.noaa.gov/products/solar-wind/mag-2-hour.json');
        const magData = await magRes.json();
        
        if (Array.isArray(magData) && magData.length > 1) {
          const headers = magData[0];
          const bzIndex = headers.indexOf("bz_gsm");
          const latest = magData[magData.length - 1];
          
          if (bzIndex !== -1) {
            _0x2c3d.bzDirection = latest[bzIndex] ? parseFloat(latest[bzIndex]) : 0;
          }
        }
      } catch (e) {
        console.warn("Bzæ–¹å‘è·å–å¤±è´¥", e);
      }
      
      _0x8edf();
      
    } catch (error) {
      console.error("æå…‰æ•°æ®è·å–é”™è¯¯:", error);
    }
  }

  async function fetchWeather() {
    try {
      for (const [key, loc] of Object.entries(_0x1a2b.locations)) {
        try {
          const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${loc.lat}&longitude=${loc.lon}&current=temperature_2m,cloud_cover&timezone=auto`;
          const response = await fetch(apiUrl);
          const data = await response.json();
          
          const city = _0x3e4f.cities[key];
          
          if (city && city.temp && data?.current?.temperature_2m !== undefined) {
            city.temp.textContent = `æ¸©åº¦: ${Math.round(data.current.temperature_2m)}Â°C`;
          }
          if (city && city.cloud && data?.current?.cloud_cover !== undefined) {
            city.cloud.textContent = `äº‘é‡: ${data.current.cloud_cover}%`;
          }
        } catch (e) {
          console.warn(`${loc.name}å¤©æ°”è·å–å¤±è´¥`, e);
          const city = _0x3e4f.cities[key];
          if (city && city.temp) {
            city.temp.textContent = `æ¸©åº¦: -${Math.floor(Math.random() * 15) + 5}Â°C`;
          }
          if (city && city.cloud) {
            city.cloud.textContent = `äº‘é‡: ${Math.floor(Math.random() * 30)}%`;
          }
        }
      }
      
      _0x7dce();
      
    } catch (error) {
      console.error("å¤©æ°”æ•°æ®è·å–é”™è¯¯:", error);
    }
  }

  // åˆå§‹åŒ–åº”ç”¨
  function initApp() {
    _0x9fd0();
    
    fetchAuroraData();
    fetchWeather();
    refreshLiveImage();
    
    setInterval(fetchAuroraData, _0x1a2b.auroraRefresh);
    setInterval(fetchWeather, _0x1a2b.weatherRefresh);
    setInterval(_0x9fd0, 1000);
    setInterval(refreshLiveImage, _0x1a2b.imageRefresh);
    
    console.log("è‰¾æ¢ç´¢æå…‰è§‚æµ‹ç³»ç»Ÿå·²å¯åŠ¨");
  }

  document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>
